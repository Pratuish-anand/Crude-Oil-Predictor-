<!-- templates/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Crude Oil Prediction Machine</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<div class="container">
    <h1>Crude Oil Prediction (2025â€“2075)</h1>
    <form id="predict-form">
        <label>
            Inflation rate (% per year):
            <input type="number" step="0.1" name="inflation" id="inflation" value="3">
        </label>

        <label>
            Economic challenges (1 = low, 10 = high):
            <input type="number" min="1" max="10" name="econ_challenges" id="econ_challenges" value="5">
        </label>

        <label>
            Government policy support (1 = low, 10 = high):
            <input type="number" min="1" max="10" name="policy_support" id="policy_support" value="5">
        </label>

        <button type="submit">Predict</button>
    </form>

    <h2>Forecast (USD per barrel)</h2>
    <table id="result-table">
        <thead>
        <tr>
            <th>Year</th>
            <th>Predicted Price (USD)</th>
        </tr>
        </thead>
        <tbody>
        <!-- rows will be added by JS -->
        </tbody>
    </table>
</div>

<script>
    const form = document.getElementById("predict-form");
    const tableBody = document.querySelector("#result-table tbody");

    form.addEventListener("submit", function (e) {
        e.preventDefault();

        const formData = new FormData(form);

        fetch("/predict", {
            method: "POST",
            body: formData
        })
            .then(response => response.json())
            .then(data => {
                tableBody.innerHTML = "";
                if (data.error) {
                    alert(data.error);
                    return;
                }
                data.forecasts.forEach(row => {
                    const tr = document.createElement("tr");
                    const tdYear = document.createElement("td");
                    const tdPrice = document.createElement("td");
                    tdYear.textContent = row.year;
                    tdPrice.textContent = row.price.toFixed(2);
                    tr.appendChild(tdYear);
                    tr.appendChild(tdPrice);
                    tableBody.appendChild(tr);
                });
            })
            .catch(err => {
                console.error(err);
                alert("Error calling API");
            });
    });
</script>
</body>
</html>
